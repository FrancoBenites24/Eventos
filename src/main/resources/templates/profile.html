<!doctype html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mi Perfil - Eventos</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  
  <!-- Agregar Swiper CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  
  <style>
:root {
  --color-primary: #00D2D3;
  --color-accent: #00D2D3;
  --color-bg: #f8fafc;
  --color-text: #0f172a;
  --shadow-md: 0 10px 30px rgba(12, 8, 24, .08);
  --accent-soft: rgba(0, 210, 211, .12);
  --brand: #00D2D3;
  --brand-2: #00D2D3;
  --ink: #0f172a;
  --muted: #475569;
  --bg-soft: #f8fafc;
  --glass: rgba(255, 255, 255, .75);
  --primary: #00D2D3;
  --primary-dark: #00a0a0;
  --secondary: #00D2D3;
  --dark: #212529;
  --light: #f8f9fa;
  --gradient: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
}
    
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f8f9fa;
    }
    
.navbar {
  --bs-navbar-brand-color: var(--color-text);
  --bs-navbar-active-color: var(--color-primary);
  box-shadow: none;
  transition: box-shadow .2s ease, border-color .2s ease;
  border-bottom: 2px solid transparent;
  background: #fff;
}

.navbar.scrolled {
  box-shadow: var(--shadow-md);
  border-bottom-color: var(--color-accent);
}

.navbar .btn-gradient {
  background: var(--color-primary);
  color: #fff;
  border: 0;
  box-shadow: 0 8px 20px rgba(0, 210, 211, .25);
}

.navbar .btn-gradient:focus {
  outline: 3px solid var(--color-accent);
  box-shadow: 0 0 0 .25rem rgba(0, 210, 211, .25);
}

.navbar-brand b {
  letter-spacing: .5px;
}

.nav-shadow {
  box-shadow: 0 10px 30px rgba(2, 8, 23, .06);
}
    
.btn-grad {
  background: var(--brand);
  border: 0;
}

.btn-grad:hover {
  background: var(--primary-dark);
  color: white;
}
    
    .card {
      border: none;
      border-radius: 12px;
      overflow: hidden;
    }
    
    .badge {
      font-weight: 500;
      padding: 0.5em 0.75em;
    }
    
    /* Estilos para el Swiper */
    .swiper-container {
      width: 100%;
      padding: 0 30px;
      position: relative;
    }
    
    .swiper {
      width: 100%;
      height: 100%;
    }
    
    .swiper-slide {
      background-position: center;
      background-size: cover;
    }
    
    .event-card {
      height: 100%;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
    }
    
    .event-card:hover {
      transform: translateY(-5px);
    }
    
    .event-card img {
      width: 100%;
      height: 250px;
      object-fit: cover;
    }
    
    .event-card .card-body {
      padding: 1.5rem;
    }
    
    .swiper-pagination-bullet-active {
      background-color: var(--primary) !important;
    }
    
    .swiper-button-next, .swiper-button-prev {
      color: var(--primary) !important;
      background-color: rgba(255, 255, 255, 0.8);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    
    .swiper-button-next:after, .swiper-button-prev:after {
      font-size: 18px;
      font-weight: bold;
    }
    
    .swiper-button-next {
      right: 10px;
    }
    
    .swiper-button-prev {
      left: 10px;
    }
    
    .swiper-pagination {
      bottom: 10px !important;
    }
    
    @media (max-width: 768px) {
      .swiper-container {
        padding: 0 20px;
      }
      
      .swiper-button-next, .swiper-button-prev {
        width: 30px;
        height: 30px;
      }
      
      .swiper-button-next:after, .swiper-button-prev:after {
        font-size: 14px;
      }
      
      .event-card img {
        height: 200px;
      }
    }
  </style>
</head>
<body>
  <nav th:replace="fragments/navbar :: navbar"></nav>
  <main>
    <section id="view-profile" class="container py-5" aria-labelledby="profile-title">
      <div class="py-4">
        <h2 id="profile-title" class="fw-bold mb-4">Mi Perfil</h2>
        <div class="row">
          <div class="col-lg-4 mb-4">
            <div class="card shadow-sm">
              <div class="card-body text-center p-4">
                <div class="position-relative d-inline-block mb-3">
                  <img src="https://picsum.photos/seed/user1/150/150.jpg" class="rounded-circle border border-4 border-white shadow-sm" alt="Foto de perfil" id="profilePhoto">
                  <button class="btn btn-sm btn-light position-absolute bottom-0 end-0 rounded-circle p-2 shadow-sm" id="changePhotoBtn" aria-label="Cambiar foto de perfil">
                    <i class="bi bi-camera"></i>
                  </button>
                </div>
                <h4 class="mb-1" id="profileNameDisplay">Usuario</h4>
                <p class="text-muted mb-3" id="profileEmailDisplay">usuario@example.com</p>
                <div class="d-flex justify-content-center mb-3">
                  <span class="badge bg-primary me-2">Miembro</span>
                  <span class="badge bg-success">Verificado</span>
                </div>
                <button class="btn btn-outline-primary w-100 mb-2" id="editProfileBtn">
                  <i class="bi bi-pencil-square me-2"></i>Editar Perfil
                </button>
                <button class="btn btn-sm btn-link text-muted w-100" id="settingsBtn">
                  <i class="bi bi-gear me-2"></i>Configuración
                </button>
              </div>
            </div>
            
            <div class="card shadow-sm mt-4">
              <div class="card-body">
                <h5 class="card-title mb-3">Billetera</h5>
                <div class="d-flex justify-content-between mb-3">
                  <span>Saldo Actual</span>
                  <span class="fw-bold" id="walletBalance">S/ 0.00</span>
                </div>
                <button class="btn btn-sm btn-outline-secondary w-100 mb-3" id="manageBalanceBtn">
                  <i class="bi bi-wallet2 me-1"></i>Gestionar Saldo
                </button>
                
                <h6 class="mb-2">Últimos Movimientos</h6>
                <div class="small" id="recentMovements">
                  <p class="text-muted small">No hay movimientos recientes</p>
                </div>
                <button class="btn btn-sm btn-link w-100 mt-2" id="viewAllMovementsBtn">
                  Ver todos los movimientos
                </button>
                
                <hr class="my-3">
                
                <h6 class="mb-2">Tarjetas Guardadas</h6>
                <div class="d-flex justify-content-between align-items-center mb-2">
                  <div>
                    <div class="fw-bold">Tarjeta de Crédito</div>
                    <div class="text-muted small">**** **** **** 1234</div>
                  </div>
                  <button class="btn btn-sm btn-outline-danger" id="editCardBtn" aria-label="Editar tarjeta">
                    <i class="bi bi-pencil"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-lg-8">
            <div class="card shadow-sm mb-4">
              <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center mb-4">
                  <h4 class="mb-0">Información Personal</h4>
                  <button class="btn btn-sm btn-outline-secondary" id="editInfoBtn">
                    <i class="bi bi-pencil me-1"></i>Editar
                  </button>
                </div>
                
                <div class="row mb-3">
                  <div class="col-md-6 mb-3">
                    <label class="form-label small text-muted">Nombre Completo</label>
                    <p class="fw-bold" id="personalName">No especificado</p>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label small text-muted">Email</label>
                    <p class="fw-bold" id="personalEmail">usuario@example.com</p>
                  </div>
                </div>

                <div class="row mb-3">
                  <div class="col-md-6 mb-3">
                    <label class="form-label small text-muted">Teléfono</label>
                    <p class="fw-bold" id="personalPhone">No especificado</p>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label small text-muted">Ubicación</label>
                    <p class="fw-bold" id="personalLocation">No especificado</p>
                  </div>
                </div>

                <div class="mb-3">
                  <label class="form-label small text-muted">Biografía</label>
                  <p id="personalBio">Amante de los eventos y experiencias culturales. Siempre buscando nuevas actividades para disfrutar y compartir.</p>
                </div>
                
                <div class="mb-3">
                  <label class="form-label small text-muted">Puntos y Nivel</label>
                  <div class="d-flex align-items-center mb-2">
                    <div class="me-3">
                      <div class="badge bg-warning text-dark fs-6" id="totalPoints">0 pts</div>
                    </div>
                    <div class="flex-fill">
                      <div class="d-flex justify-content-between mb-1">
                        <span id="levelDisplay">Nivel 1</span>
                        <span id="pointsToNextLevel">100 pts para siguiente nivel</span>
                      </div>
                      <div class="progress" style="height: 10px;">
                        <div class="progress-bar bg-warning" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" id="levelProgressBar"></div>
                      </div>
                    </div>
                  </div>
                  <div class="small text-muted">
                    Cada 1 sol gastado te da 0.5 puntos. Acumula puntos para subir de nivel.
                  </div>
                </div>
              </div>
            </div>
            
            <div class="card shadow-sm mb-4">
              <div class="card-body p-4">
                <h4 class="mb-4">Próximos Eventos</h4>
                <div id="upcomingEventsContainer">
                  <p class="text-muted">No tienes próximos eventos.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal para editar perfil -->
  <div class="modal fade" id="editProfileModal" tabindex="-1" aria-labelledby="editProfileModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="editProfileModalLabel">Editar Perfil</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="editProfileForm">
            <div class="mb-3">
              <label for="profileName" class="form-label">Nombre Completo</label>
              <input type="text" class="form-control" id="profileName" required>
            </div>
            <div class="mb-3">
              <label for="profileEmail" class="form-label">Email</label>
              <input type="email" class="form-control" id="profileEmail" required>
            </div>
            <div class="mb-3">
              <label for="profilePhone" class="form-label">Teléfono</label>
              <input type="tel" class="form-control" id="profilePhone">
            </div>
            <div class="mb-3">
              <label for="profileLocation" class="form-label">Ubicación</label>
              <input type="text" class="form-control" id="profileLocation">
            </div>
            <div class="mb-3">
              <label for="profileBio" class="form-label">Biografía</label>
              <textarea class="form-control" id="profileBio" rows="3"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-primary" id="saveProfileBtn">Guardar Cambios</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para configurar perfil -->
  <div class="modal fade" id="settingsModal" tabindex="-1" aria-labelledby="settingsModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="settingsModalLabel">Configuración de Perfil</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <h6>Notificaciones</h6>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="notifEvents" checked>
              <label class="form-check-label" for="notifEvents">
                Recordatorios de eventos
              </label>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="notifOffers" checked>
              <label class="form-check-label" for="notifOffers">
                Ofertas especiales
              </label>
            </div>
          </div>
          <div class="mb-3">
            <h6>Privacidad</h6>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="privProfile" checked>
              <label class="form-check-label" for="privProfile">
                Perfil público
              </label>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-primary" id="saveSettingsBtn">Guardar Cambios</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para configurar saldo -->
  <div class="modal fade" id="balanceModal" tabindex="-1" aria-labelledby="balanceModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="balanceModalLabel">Gestionar Saldo</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <h6>Saldo Actual</h6>
            <div class="fs-4 fw-bold" id="currentBalance">S/ 0.00</div>
          </div>
          <div class="mb-3">
            <label for="addBalance" class="form-label">Agregar Saldo</label>
            <div class="input-group">
              <span class="input-group-text">S/</span>
              <input type="number" class="form-control" id="addBalance" min="1" value="20">
              <button class="btn btn-primary" id="addBalanceBtn">Agregar</button>
            </div>
          </div>
          <div class="mb-3">
            <h6>Métodos de Pago</h6>
            <div class="list-group">
              <div class="list-group-item">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <div class="fw-bold">Tarjeta de Crédito</div>
                    <div class="text-muted small">**** **** **** 1234</div>
                  </div>
                  <button class="btn btn-sm btn-outline-danger">Eliminar</button>
                </div>
              </div>
            </div>
            <button class="btn btn-sm btn-outline-secondary mt-2 w-100">Agregar Método de Pago</button>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <div class="offcanvas offcanvas-end" tabindex="-1" id="cartOffcanvas" aria-labelledby="cartOffcanvasLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title d-flex align-items-center" id="cartOffcanvasLabel">
        <i class="bi bi-bag me-2"></i>Tu carrito
      </h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Cerrar"></button>
    </div>
    <div class="offcanvas-body d-flex flex-column">
      <div id="cartLines" class="flex-grow-1 small" aria-live="polite">
        <div class="text-center text-body-secondary py-5">
          <i class="bi bi-bag-dash fs-1 d-block mb-3"></i>
          <p class="mb-0">Tu carrito está vacío</p>
        </div>
      </div>
      <div class="border-top pt-3">
        <div class="input-group input-group-sm mb-2">
          <span class="input-group-text"><i class="bi bi-ticket-perforated"></i></span>
          <input id="couponInput" type="text" class="form-control" placeholder="Cupón (FIESTA20)">
          <button id="applyCouponBtn" class="btn btn-outline-secondary">Aplicar</button>
        </div>
        <div class="d-flex justify-content-between"><span>Subtotal</span><strong id="cartSubtotal">S/ 0.00</strong></div>
        <div class="d-flex justify-content-between small text-body-secondary"><span>Desc. por cantidad</span><span id="cartQtyDiscount">S/ 0.00</span></div>
        <div class="d-flex justify-content-between small text-body-secondary"><span>Cupones</span><span id="cartCoupon">S/ 0.00</span></div>
        <div class="d-flex justify-content-between mt-2 fs-5"><span>Total</span><strong id="cartTotal">S/ 0.00</strong></div>
        <button id="btnGoCheckout" class="btn btn-primary w-100 mt-3" data-bs-dismiss="offcanvas" aria-label="Ir al checkout">
          <i class="bi bi-cash-coin me-2"></i>Continuar al pago
        </button>
      </div>
    </div>
  </div>

  <div class="position-fixed top-0 end-0 p-3" style="z-index: 1090;">
    <div id="toasts" class="toast-container"></div>
  </div>

<footer th:replace="fragments/footer :: footer"></footer>

  <!-- Cargar scripts al final -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="api.js"></script>
  
  <!-- Agregar Swiper JS -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  
  <script src="profile.js"></script>
</body>
</html>
